set(QT_USE_QTNETWORK TRUE)
set(QT_USE_QTXML TRUE)
include(${QT_USE_FILE})
include_directories(libkode)

remove_definitions(-DQT_NO_CAST_TO_ASCII -DQT_NO_CAST_FROM_ASCII -DQT_NO_CAST_FROM_BYTEARRAY)
set(CMAKE_INCLUDE_CURRENT_DIR ON)

set(SOURCES_LIB
  libkode/common/fileprovider.cpp
  libkode/common/messagehandler.cpp
  libkode/common/nsmanager.cpp
  libkode/common/parsercontext.cpp
  libkode/common/qname.cpp
  libkode/libkode/code.cpp
  libkode/libkode/enum.cpp
  libkode/libkode/style.cpp
  libkode/libkode/printer.cpp
  libkode/libkode/license.cpp
  libkode/libkode/file.cpp
  libkode/libkode/class.cpp
  libkode/libkode/function.cpp
  libkode/libkode/variable.cpp
  libkode/libkode/membervariable.cpp
  libkode/libkode/typedef.cpp
  libkode/libkode/statemachine.cpp
  libkode/schema/annotation.cpp
  libkode/schema/attribute.cpp
  libkode/schema/complextype.cpp
  libkode/schema/element.cpp
  libkode/schema/parser.cpp
  libkode/schema/simpletype.cpp
  libkode/schema/types.cpp
  libkode/schema/xmlelement.cpp
  libkode/schema/xsdtype.cpp
  libkode/schema/attributegroup.cpp
  libkode/schema/compositor.cpp
  libkode/schema/group.cpp
  wsdl/binding.cpp
  wsdl/bindingoperation.cpp
  wsdl/definitions.cpp
  wsdl/element.cpp
  wsdl/fault.cpp
  wsdl/import.cpp
  wsdl/message.cpp
  wsdl/operation.cpp
  wsdl/param.cpp
  wsdl/part.cpp
  wsdl/port.cpp
  wsdl/porttype.cpp
  wsdl/service.cpp
  wsdl/soapbinding.cpp
  wsdl/type.cpp
  wsdl/wsdl.cpp
  src/compiler.cpp
  src/converter.cpp
  src/converter_clientstub.cpp
  src/converter_complextype.cpp
  src/converter_serverstub.cpp
  src/converter_simpletype.cpp
  src/creator.cpp
  src/elementargumentserializer.cpp
  src/namemapper.cpp
  src/settings.cpp
  src/typemap.cpp
)

set(SOURCES_EXE src/main.cpp)

add_library(kdwsdl2cpp_lib STATIC ${SOURCES_LIB})
target_link_libraries(kdwsdl2cpp_lib ${QT_LIBRARIES})

add_executable(kdwsdl2cpp ${SOURCES_EXE})
target_link_libraries(kdwsdl2cpp kdwsdl2cpp_lib ${QT_LIBRARIES})

install(TARGETS kdwsdl2cpp EXPORT "KDSoapTargets"
  RUNTIME DESTINATION ${INSTALL_RUNTIME_DIR}
  BUNDLE DESTINATION .
)
